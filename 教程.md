# 办公自动化工具箱 - 新手使用教程

欢迎使用 **办公自动化工具箱**！本软件旨在帮助您高效处理日常办公中的 Excel 表格合并与 CAD (DXF) 图纸数据提取任务。

---

## 🚀 快速开始

1.  **打开软件**：双击运行文件夹中的 `index.html` 文件（建议使用 Chrome 或 Edge 浏览器打开）。
2.  **选择功能**：软件顶部有三个主要功能标签：
    *   **📐 DWG 工具**：处理 CAD 图纸相关任务。
    *   **📊 Excel 工具**：强大的表格合并与处理功能。
    *   **📝 Word 工具**：（开发中）

---

## 📊 Excel 工具使用指南

这是本软件的核心功能，提供了 8 种不同的合并模式，满足各种场景需求。

### 第一步：添加文件
*   点击 **"📁 将 Excel 文件拖拽到此处..."** 区域，或直接将文件拖入框内。
*   支持 `.xlsx` 和 `.xls` 格式。

### 第二步：选择合并模式
鼠标悬停在功能按钮上，可以看到**动态演示动画**和详细说明。

1.  **📂 多工作簿 -> 工作簿**
    *   *场景*：你有 10 个 Excel 文件，想把它们原来的所有 Sheet 完好无损地放进一个新的 Excel 文件里。
    *   *结果*：生成 1 个新文件，包含所有原文件的 Sheet，并自动生成一个带有超链接的**目录索引页**。

2.  **📑 多工作簿 -> 工作表** (最常用)
    *   *场景*：你有 50 张格式相同的“日报表”，想把它们的数据全部汇总到一张大表里。
    *   *设置*：
        *   **保留表头**：设为 `1`，则每个文件只取数据，跳过表头（第一个文件除外）。
        *   **排列方向**：通常选择“竖向叠加”。

3.  **🔄 工作簿内部汇总**
    *   *场景*：一个文件里有 12 个 Sheet（1月、2月...），想把它们合并成一个“全年汇总” Sheet。
    *   *结果*：在原文件内生成一个新的“全工作簿汇总” Sheet。

4.  **🏷️ 同名 Sheet 汇总**
    *   *场景*：收集了 10 个人的考勤表，每个人都有“出勤”和“请假”两个 Sheet。你只想把所有人的“请假” Sheet 抽出来合并。
    *   *结果*：自动按 Sheet 名称归类合并。

5.  **🎯 指定位置/单元格提取**
    *   *场景*：从 100 份合同里，提取单元格 `C3` (姓名) 和 `F20` (总金额)。
    *   *设置*：在输入框填写 `C3,F20`。
    *   *结果*：生成一张清单列表，每行代表一个文件。

6.  **📁 同名文件汇总**
    *   *场景*：某些特殊归档需求。
    *   *结果*：处理同名文件的冲突，或生成索引。

7.  **🤝 多人协同冲突合并** (🔥 特色功能)
    *   *场景*：通过微信群发了一张表给 5 个人填，每个人只填了自己的那几行，现在收回来 5 个文件。
    *   *功能*：自动将 5 个文件合并。
    *   *冲突检测*：如果张三和李四修改了同一个单元格，系统会**标记红色**，并在行末备注冲突详情（如 `[张三.xlsx: 100], [李四.xlsx: 200]`）。

### 第三步：预览与处理
*   **👁️ 预览结果**：点击橙色按钮，弹窗查看合并后的前 50 行数据，确认无误。
*   **🚀 开始处理**：点击蓝色按钮，处理完成后会自动下载结果文件。

---

## 📐 DWG (CAD) 工具使用指南

本工具专为处理 `.dxf` 格式图纸设计（请先将 `.dwg` 另存为 `.dxf`）。

### 1. 🔍 DXF 关键字查找
*   **功能**：在几百张图纸中，快速查找包含特定文字（如“预埋件”、“C30”）的图纸。
*   **操作**：
    1.  拖入 DXF 文件（支持文件夹）。
    2.  输入关键字（逗号分隔）。
    3.  点击扫描，结果列表中会显示匹配的文件和具体位置。

### 2. 🧰 阀门风口信息统计
*   **功能**：一键提取图纸中的阀门、风口等设备的编号、尺寸、标高信息。
*   **结果**：支持导出为 Excel 表格，方便做预算或材料清单。

### 3. 🔄 DWG 文字内容替换
*   **功能**：批量修改图纸中的文字。例如将所有图纸标题栏中的“设计阶段”改为“施工图”。
*   **特色**：支持**预览**替换结果，确认无误后再执行替换并保存。

---

## ❓ 常见问题 (FAQ)

**Q: 为什么 Excel 预览看不到图片？**
A: 目前预览功能仅支持查看文本和数值数据，图片和复杂图表建议下载后查看。

**Q: 处理大文件时浏览器卡顿？**
A: 这是正常现象。因为所有处理都在本地浏览器完成（数据不上传服务器，安全保密），处理几百兆文件时会占用较多内存。建议分批处理。

**Q: 为什么 DWG 工具只能用 DXF？**
A: `.dwg` 是加密的二进制格式，浏览器无法直接读取。请在 CAD 软件中“另存为”选择 `AutoCAD 2000/2004/2007 DXF` 格式即可。

---
*祝您工作愉快，效率倍增！*
