# 办公自动化工具箱功能需求整理与实现状态

## 📊 Excel 工具集 (已实现)

| 功能模式                           | 描述                                                                                     | 实现状态 | 配置选项                                                           | 备注                                                                       |
| :--------------------------------- | :--------------------------------------------------------------------------------------- | :------- | :----------------------------------------------------------------- | :------------------------------------------------------------------------- |
| **多工作簿提取到一个工作簿**       | 选择多个Excel文件，将所有Sheet复制到一个新工作簿中，每个Sheet重命名为"文件名-工作表名"。 | ✅ 已实现 | 无                                                                 | 自动生成"索引"工作表，包含带蓝色下划线的跳转链接。                         |
| **多工作簿提取到一个工作表**       | 将多个文件的数据合并到一个Sheet中。支持纵向堆叠（追加行）或横向并列（追加列）。          | ✅ 已实现 | 1. 排列方向 (纵向/横向)<br>2. 保留表头行数<br>3. 去除表尾行数      | 默认添加"Source"列标记来源。纵向合并保留完整格式（字体/颜色/合并单元格）。 |
| **一个工作簿提取到一个工作表**     | 同一文件内的所有Sheet合并到一个总表中。                                                  | ✅ 已实现 | 1. 汇总方式 (最前/合并/最后)<br>2. 保留表头行数<br>3. 去除表尾行数 | 添加"源工作表"列。                                                         |
| **多工作簿同名表提取到一个工作表** | 跨文件合并名称相同的Sheet（如都有"Sheet1"）。                                            | ✅ 已实现 | 1. 保留表头行数<br>2. 去除表尾行数                                 | 自动按Sheet名分组生成的Sheet。                                             |
| **同位置提取到一个工作表**         | 提取所有文件中指定单元格（如A1, B2）的值，形成清单列表。                                 | ✅ 已实现 | 1. 指定单元格 (为空则提取整表)                                     | 若指定单元格，输出为简表；若为空，则等同于合并所有文件的第一个Sheet。      |
| **同文件名提取到一个工作簿**       | 处理不同目录下同名文件的情况。                                                           | ✅ 已实现 | 1. 同名处理 (重命名/跳过)                                          | 类似模式1，但专用于同名文件场景，生成索引页。                              |
| **合并动态字段**                   | 按照表头（字段名）合并数据，自动对齐不同列序的数据。                                     | ✅ 已实现 | 无                                                                 | 仅保留数据值，不保留格式。适用于纯数据表合并。                             |

### Excel 通用特性
1.  **格式保留**：采用深度复制技术，保留单元格字体、颜色、边框、合并状态及行高列宽（仅限纵向合并模式）。
2.  **样式链接**：生成的索引页和来源列链接统一应用蓝色下划线样式。
3.  **大文件处理**：使用了 `xlsx.full.min.js`，支持较大文件的浏览器端解析。

---

## 📐 CAD (DXF) 工具集 (已实现)

| 功能模块                  | 描述                                                               | 实现状态 | 配置选项                                                      | 备注                                                            |
| :------------------------ | :----------------------------------------------------------------- | :------- | :------------------------------------------------------------ | :-------------------------------------------------------------- |
| **DXF 关键字查找**        | 批量扫描多个 DXF 文件，查找包含特定关键字的文本实体。              | ✅ 已实现 | 1. 关键字（逗号分隔）<br>2. 筛选器（图层、类型、内容）        | 支持 Web Worker 多线程并发解析。支持 CSV/Excel 导出（带链接）。 |
| **DXF 阀门/风口信息统计** | 智能识别图纸中的设备信息（基于文本相对位置识别编号、尺寸、标高）。 | ✅ 已实现 | 无                                                            | 针对特定机电图纸格式优化规则。支持导出统计报表。                |
| **DXF 图纸文字内容替换**  | 批量替换图纸中的文字内容。支持预览替换前后的效果。                 | ✅ 已实现 | 1. 替换规则（支持正则）<br>2. 写入方式（覆盖原文件/下载副本） | 支持 Chrome 文件系统 API 直接写入本地（需授权）。               |

### DXF 通用特性
1.  **本地解析**：使用 `dxf-parser` 在浏览器端解析，不上传文件。
2.  **高性能**：大文件自动降级处理策略，多线程并发。
3.  **交互**：支持拖拽上传、结果筛选排序、一键导出。